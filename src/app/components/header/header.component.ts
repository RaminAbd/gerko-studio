import { Component } from '@angular/core';
import { NgClass, NgForOf, NgIf } from '@angular/common';
import { Router, RouterLink, RouterLinkActive } from '@angular/router';
import { TranslateModule, TranslateService } from '@ngx-translate/core';
import {
  animate,
  state,
  style,
  transition,
  trigger,
} from '@angular/animations';
import { DomSanitizer, SafeHtml } from '@angular/platform-browser';
import { StorageService } from '../../core/services/storage.service';

@Component({
  selector: 'mrn-header',
  standalone: true,
  imports: [RouterLink, RouterLinkActive, TranslateModule, NgClass, NgForOf],
  animations: [
    trigger('menuExpand', [
      state(
        'open',
        style({
          width: '*',
          visibility: 'visible',
          display: 'block',
        })
      ),
      state(
        'closed',
        style({
          width: '0px',
          visibility: 'hidden',
        })
      ),
      transition('open <=> closed', [animate('500ms ease-in-out')]),
    ]),
  ],
  templateUrl: './header.component.html',
  styleUrl: './header.component.scss',
})
export class HeaderComponent {
  showMenu: boolean = false;
  isHidden = false;
  sections: any[] = [
    {
      name: 'Portal menu',
      links: [
        {
          name: 'News',
          url: 'admin/news',
          icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3 4V18C3 18.5304 3.21071 19.0391 3.58579 19.4142C3.96086 19.7893 4.46957 20 5 20H19C19.5304 20 20.0391 19.7893 20.4142 19.4142C20.7893 19.0391 21 18.5304 21 18V8H17" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M3 4H17V18C17 18.5304 17.2107 19.0391 17.5858 19.4142C17.9609 19.7893 18.4696 20 19 20M13 8H7M13 12H9" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`,
        },
        {
          name: 'Regions',
          url: 'admin/regions',
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="22" height="24" viewBox="0 0 36 36" fill="none">
  <path d="M2.55789 33.5368C1.92632 33.7895 1.34211 33.7187 0.805263 33.3246C0.268421 32.9305 0 32.4013 0 31.7368V5.21053C0 4.8 0.118737 4.43684 0.35621 4.12105C0.593684 3.80526 0.917053 3.56842 1.32632 3.41053L11.3684 0L22.7368 3.97895L31.5474 0.568421C32.1789 0.315789 32.7632 0.387158 33.3 0.782527C33.8368 1.17789 34.1053 1.70653 34.1053 2.36842V18.3316C33 16.7211 31.6187 15.4737 29.9615 14.5895C28.3042 13.7053 26.5276 13.2632 24.6316 13.2632C24 13.2632 23.3684 13.3187 22.7368 13.4299C22.1053 13.5411 21.4737 13.7065 20.8421 13.9263V7.29474L13.2632 4.64211V29.4158L2.55789 33.5368ZM33.3474 36L28.5158 31.1684C27.9474 31.5158 27.3398 31.7766 26.6931 31.9509C26.0463 32.1253 25.3592 32.2118 24.6316 32.2105C22.5474 32.2105 20.7632 31.4684 19.2789 29.9842C17.7947 28.5 17.0526 26.7158 17.0526 24.6316C17.0526 22.5474 17.7947 20.7632 19.2789 19.2789C20.7632 17.7947 22.5474 17.0526 24.6316 17.0526C26.7158 17.0526 28.5 17.7947 29.9842 19.2789C31.4684 20.7632 32.2105 22.5474 32.2105 24.6316C32.2105 25.3579 32.124 26.0451 31.9509 26.6931C31.7779 27.3411 31.5171 27.9486 31.1684 28.5158L36 33.3474L33.3474 36ZM24.6316 28.4211C25.7053 28.4211 26.5977 28.1053 27.3088 27.4737C28.02 26.8421 28.3907 25.8947 28.4211 24.6316C28.4526 23.5579 28.0977 22.6579 27.3562 21.9316C26.6147 21.2053 25.7065 20.8421 24.6316 20.8421C23.5566 20.8421 22.6566 21.2053 21.9316 21.9316C21.2065 22.6579 20.8434 23.5579 20.8421 24.6316C20.8408 25.7053 21.204 26.6053 21.9316 27.3316C22.6592 28.0579 23.5592 28.4211 24.6316 28.4211Z" fill="#FEFFFD"/>
</svg>`,
        },
        {
          name: 'Reportages',
          url: 'admin/reportages',
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 42 40" fill="none">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M6.29053 2.09674C6.29053 1.54065 6.51145 1.00733 6.90468 0.61412C7.29791 0.220906 7.83125 0 8.38737 0H18.7248C19.7604 7.52279e-05 20.7799 0.255794 21.6929 0.744459C22.6059 1.23312 23.3841 1.93962 23.9585 2.80124L26.286 6.29021H27.259C28.9273 6.29021 30.5273 6.95292 31.707 8.13257C32.8867 9.31221 33.5495 10.9121 33.5495 12.5804V13.0207L37.1414 10.8066C37.6178 10.513 38.1639 10.3518 38.7233 10.3397C39.2828 10.3275 39.8354 10.4649 40.3241 10.7375C40.8127 11.0101 41.2198 11.4082 41.5033 11.8907C41.7868 12.3731 41.9365 12.9224 41.9369 13.482V24.255C41.9369 24.8148 41.7875 25.3644 41.5041 25.8471C41.2208 26.3299 40.8137 26.7283 40.325 27.0011C39.8362 27.274 39.2835 27.4115 38.7239 27.3995C38.1642 27.3874 37.6179 27.2263 37.1414 26.9326L33.5495 24.7205V25.1608C33.5495 26.8291 32.8867 28.429 31.707 29.6087C30.5273 30.7883 28.9273 31.451 27.259 31.451H6.29053C4.62218 31.451 3.02216 30.7883 1.84245 29.6087C0.66275 28.429 0 26.8291 0 25.1608V12.5804C0 10.9121 0.66275 9.31221 1.84245 8.13257C3.02216 6.95292 4.62218 6.29021 6.29053 6.29021H21.2452L20.4694 5.12652C20.2778 4.83944 20.0184 4.60408 19.7141 4.44132C19.4097 4.27855 19.0699 4.19342 18.7248 4.19347H8.38737C7.83125 4.19347 7.29791 3.97257 6.90468 3.57935C6.51145 3.18614 6.29053 2.65282 6.29053 2.09674ZM25.1328 10.4837H6.29053C5.73441 10.4837 5.20107 10.7046 4.80784 11.0978C4.4146 11.491 4.19369 12.0243 4.19369 12.5804V25.1608C4.19369 25.7169 4.4146 26.2502 4.80784 26.6434C5.20107 27.0367 5.73441 27.2576 6.29053 27.2576H27.259C27.8151 27.2576 28.3484 27.0367 28.7416 26.6434C29.1349 26.2502 29.3558 25.7169 29.3558 25.1608V12.5804C29.3558 12.0243 29.1349 11.491 28.7416 11.0978C28.3484 10.7046 27.8151 10.4837 27.259 10.4837H25.1936H25.1328ZM33.5495 19.7953L37.7432 22.3785V15.3607L33.5495 17.9439V19.7953Z" fill="#FEFFFD"/>
</svg>`,
        },
        {
          name: 'Podcasts',
          url: 'admin/podcasts',
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 26 38" fill="none">
  <path d="M13 0C9.08523 0 5.90909 3.19141 5.90909 7.125V19C5.90909 22.9336 9.08523 26.125 13 26.125C16.9148 26.125 20.0909 22.9336 20.0909 19V7.125C20.0909 3.19141 16.9148 0 13 0ZM3.54545 16.0312C3.54545 15.0441 2.75511 14.25 1.77273 14.25C0.790341 14.25 0 15.0441 0 16.0312V19C0 25.6129 4.88977 31.0754 11.2273 31.9437V34.4375H7.68182C6.69943 34.4375 5.90909 35.2316 5.90909 36.2188C5.90909 37.2059 6.69943 38 7.68182 38H18.3182C19.3006 38 20.0909 37.2059 20.0909 36.2188C20.0909 35.2316 19.3006 34.4375 18.3182 34.4375H14.7727V31.9437C21.1102 31.0754 26 25.6129 26 19V16.0312C26 15.0441 25.2097 14.25 24.2273 14.25C23.2449 14.25 22.4545 15.0441 22.4545 16.0312V19C22.4545 24.2473 18.2222 28.5 13 28.5C7.77784 28.5 3.54545 24.2473 3.54545 19V16.0312Z" fill="#FEFFFD"/>
</svg>`,
        },
        {
          name: 'Images',
          url: 'admin/images',
          icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M22 16V4C22 3.46957 21.7893 2.96086 21.4142 2.58579C21.0391 2.21071 20.5304 2 20 2H8C7.46957 2 6.96086 2.21071 6.58579 2.58579C6.21071 2.96086 6 3.46957 6 4V16C6 16.5304 6.21071 17.0391 6.58579 17.4142C6.96086 17.7893 7.46957 18 8 18H20C20.5304 18 21.0391 17.7893 21.4142 17.4142C21.7893 17.0391 22 16.5304 22 16ZM11 12L13.03 14.71L16 11L20 16H8M2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18V20H4V6" fill="white"/>
</svg>

`,
        },
        {
          name: 'Videos',
          url: 'admin/videos',
          icon: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 8H2V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H16V20H4V8Z" fill="white"/>
<path d="M20 2H8C7.46957 2 6.96086 2.21071 6.58579 2.58579C6.21071 2.96086 6 3.46957 6 4V16C6 16.5304 6.21071 17.0391 6.58579 17.4142C6.96086 17.7893 7.46957 18 8 18H20C20.5304 18 21.0391 17.7893 21.4142 17.4142C21.7893 17.0391 22 16.5304 22 16V4C22 3.46957 21.7893 2.96086 21.4142 2.58579C21.0391 2.21071 20.5304 2 20 2ZM11 14V6L18 10L11 14Z" fill="white"/>
</svg>

`,
        },
        {
          name: 'Caricatures',
          url: 'admin/caricatures',
          icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 39 40" fill="none">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9645 1.64856C14.4639 0.558639 17.1593 -0.00249384 19.8833 8.33138e-06C22.6073 0.0025105 25.3017 0.568594 27.7992 1.6631C30.2967 2.75762 32.5439 4.35718 34.4013 6.36247C36.2588 8.36776 37.6867 10.7359 38.5965 13.32C39.3631 15.4857 39.0224 17.9657 37.7023 19.84C37.0403 20.7694 36.1686 21.5275 35.1588 22.052C34.1491 22.5765 33.0301 22.8524 31.8938 22.8571H26.585C25.5662 22.8535 24.5799 23.2175 23.805 23.8832C23.0302 24.5489 22.5182 25.4722 22.3619 26.4853C22.2056 27.4985 22.4154 28.5345 22.9533 29.4053C23.4911 30.2761 24.3213 30.924 25.2933 31.2314C26.8547 31.8171 27.9477 33.2371 28.0527 34.9056C28.1552 35.8542 27.9245 36.8089 27.4008 37.6042C26.8771 38.3995 26.0933 38.9853 25.1854 39.2599C23.4513 39.7559 21.6567 40.005 19.8539 39.9999C16.2125 39.9977 12.6417 38.9886 9.53148 37.0828C6.4333 35.1622 3.91306 32.4291 2.24111 29.1765C0.569154 25.9239 -0.19144 22.2746 0.0409088 18.62C0.310611 14.9683 1.56288 11.4595 3.66343 8.46964C5.76398 5.47982 8.63356 3.12184 11.9645 1.64856ZM12.3903 20C12.9495 20 13.5033 19.8891 14.0199 19.6737C14.5366 19.4583 15.006 19.1427 15.4014 18.7447C15.7969 18.3467 16.1105 17.8743 16.3246 17.3543C16.5386 16.8344 16.6487 16.2771 16.6487 15.7142C16.6487 15.1514 16.5386 14.5941 16.3246 14.0742C16.1105 13.5542 15.7969 13.0818 15.4014 12.6838C15.006 12.2858 14.5366 11.9701 14.0199 11.7548C13.5033 11.5394 12.9495 11.4285 12.3903 11.4285C11.2609 11.4285 10.1778 11.8801 9.37914 12.6838C8.58054 13.4875 8.13188 14.5776 8.13188 15.7142C8.13188 16.8509 8.58054 17.941 9.37914 18.7447C10.1778 19.5484 11.2609 20 12.3903 20ZM29.4239 11.4285C29.4239 12.5652 28.9753 13.6553 28.1767 14.459C27.3781 15.2627 26.2949 15.7142 25.1655 15.7142C24.0361 15.7142 22.953 15.2627 22.1544 14.459C21.3558 13.6553 20.9071 12.5652 20.9071 11.4285C20.9071 10.2919 21.3558 9.20182 22.1544 8.39809C22.953 7.59436 24.0361 7.14284 25.1655 7.14284C26.2949 7.14284 27.3781 7.59436 28.1767 8.39809C28.9753 9.20182 29.4239 10.2919 29.4239 11.4285ZM12.3903 29.9999C13.1432 29.9999 13.8653 29.6989 14.3977 29.1631C14.9301 28.6273 15.2292 27.9006 15.2292 27.1428C15.2292 26.385 14.9301 25.6583 14.3977 25.1225C13.8653 24.5867 13.1432 24.2857 12.3903 24.2857C11.6374 24.2857 10.9153 24.5867 10.3829 25.1225C9.85046 25.6583 9.55135 26.385 9.55135 27.1428C9.55135 27.9006 9.85046 28.6273 10.3829 29.1631C10.9153 29.6989 11.6374 29.9999 12.3903 29.9999Z" fill="#FEFFFD"/>
</svg>`,
        },
      ],
    },
  ];
  constructor(
    private router: Router,
    private storage: StorageService,
    private sanitizer: DomSanitizer
  ) {}

  toggleMenu() {
    this.showMenu = !this.showMenu;
    var questPages = document.querySelector('.burger') as Element;
    var header = document.querySelector('header') as Element;
    if (this.showMenu) {
      questPages.classList.add('active');
      header.classList.add('active');
      setTimeout(() => {
        this.isHidden = true;
      }, 500);
    } else {
      questPages.classList.remove('active');
      header.classList.remove('active');
      this.isHidden = false;
    }
  }

  closeBurger() {
    this.showMenu = false;
    var questPages = document.querySelector('.burger') as Element;
    var header = document.querySelector('header') as Element;
    questPages.classList.remove('active');
    header.classList.remove('active');
  }

  onAnimationDone() {
    if (!this.showMenu) {
      this.isHidden = true;
    }
  }

  async logout() {
    await this.router.navigateByUrl('/').then(() => {
      this.clearStorage();
    });
  }
  clearStorage() {
    this.storage.removeObject('role');
    this.storage.removeObject('authResponse');
    this.storage.removeObject('authRequest');
    this.storage.removeObject('userInfo');
  }

  sanitize(html: string): SafeHtml {
    return this.sanitizer.bypassSecurityTrustHtml(html);
  }
}
